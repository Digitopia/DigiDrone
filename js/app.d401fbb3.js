(function(t){function e(e){for(var o,a,s=e[0],l=e[1],c=e[2],h=0,v=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&v.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(v.length)v.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={app:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/DigiDrone/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e623"),n("e379"),n("5dc8"),n("37e1");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("svg",{attrs:{id:"canvas",viewBox:"0 0 "+t.width+" "+t.height},on:{touchstart:function(e){return t.touch(e)},mousedown:function(e){return t.click(e)}}},[t._l(t.improvCircles,(function(t){return n("circle",{key:t.id,staticClass:"improv-circle",attrs:{cx:t.x,cy:t.y,r:t.r,id:t.id}})})),n("path",{staticClass:"drone-area",attrs:{d:t.curveStr},on:{click:function(t){t.stopPropagation()}}}),t._l(t.knobs,(function(e){return n("g",{key:e.id,staticClass:"knob",attrs:{id:e.id},on:{mousedown:function(t){t.stopPropagation()},touchstart:function(t){t.stopPropagation()}}},[n("circle",{attrs:{r:t.knobRadius}}),n("text",{class:{icons:"volume"===e.id},attrs:{dy:".3em"}},[t._v(" "+t._s("volume"===e.id?"":e.activeLabel)+" ")])])}))],2),n("div",{staticClass:"controls"},[n("i",{staticClass:"fa play",class:t.playing?"fa-stop ":"fa-play",on:{click:t.toggleDrone}})])])},r=[],a=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("d81d"),n("159b"),n("2909")),s=n("8cc4"),l=n.n(s),c=n("642d"),u=n.n(c),h=n("dafb"),v=n("cffa"),d=n("2ef0"),p=n("5698"),f=n("c740");function m(t,e,n,o,i){return(t-e)/(n-e)*(i-o)+o}function y(t,e){console.log(t,e.map((function(t){return t.scientific()})))}window.teoria=u.a,window.Tone=l.a,window.map=m;var g={name:"app",data:function(){return{touched:!1,width:1600,height:900,playing:!1,lastImprovCircleId:0,curvePoints:[],improvCircles:[],improvNoteDuration:l.a.Time("4n"),knobs:[{id:"root",value:"C",activeLabel:"Dó",activeValue:"C2",options:[{value:"C2",label:"Dó"},{value:"C#2",label:"Dó♯"},{value:"D2",label:"Ré"},{value:"Eb2",label:"Mi♭"},{value:"E2",label:"Mi"},{value:"F2",label:"Fá"},{value:"F#2",label:"Fá♯"},{value:"G2",label:"Sol"},{value:"G#2",label:"Sol♯"},{value:"A2",label:"Lá"},{value:"Bb2",label:"Si♭"},{value:"B2",label:"Si"}]},{id:"chord",activeLabel:"aug",activeValue:"aug",options:[{value:"dim",label:"o"},{value:"min7b5",label:"ø"},{value:"m",label:"m"},{value:"min7",label:"m7"},{value:"dom7",label:"7"},{value:"M",label:"M"},{value:"maj7",label:"Δ7"},{value:"aug",label:"+"}]},{id:"pulse",activeLabel:"3",activeValue:3,options:[{value:"1n",label:"●"},{value:"2n",label:"●●"},{value:"4n",label:"●●●"},{value:"8n",label:"●●●●"},{value:"16n",label:"●●●●●"}]},{id:"volume",activeValue:-20,activeLabel:"&#xf027;",minValue:-30,maxValue:-16}],scales:{aug:"wholetone",maj7:"lydian",dom7:"mixolydian",M:"major",min7:"dorian",m:"aeolian",min7b5:"locrian",dim:"octatonic"}}},computed:{middleY:function(){return this.height/2},halfThird:function(){return this.height/2/3},minY:function(){return this.middleY-this.halfThird},maxY:function(){return this.middleY+this.halfThird},knobRadius:function(){var t=.05*this.width,e=Math.max(25,Math.min(50,t));return console.log({r:e,per:t}),e},root:function(){return this.knobs.find((function(t){return"root"===t.id})).activeValue},chord:function(){return this.knobs.find((function(t){return"chord"===t.id})).activeValue},pulse:function(){return this.knobs.find((function(t){return"pulse"===t.id})).activeValue},volume:function(){return this.knobs.find((function(t){return"volume"===t.id})).activeValue},scale:function(){return this.scales[this.chord]},curveStr:function(){if(this.curveFunction)return this.curveFunction(this.curvePoints)},curveFunction:function(){return p["a"]().x((function(t){return t.x})).y1((function(t){return t.y})).y0(this.height).curve(p["b"].alpha(.5))},droneNotes:function(){var t=u.a.note(this.root).chord(this.chord).notes();return t.push(t.shift().interval("P8")),t.push(t.shift().interval("P8")),t.push(t[0].interval("P8")),t},improvNotes:function(){if("octatonic"===this.scale){var t=[];t.push(u.a.note(this.root));for(var e=1;e<8;e++){var n=t[e-1],o=e%2===1?"M2":"m2",i=u.a.interval.from(n,o);t.push(i)}return t.map((function(t){return t.interval("P8").interval("P8")}))}var r=u.a.note(this.root).scale(this.scale).interval("P8").interval("P8").interval("P8").notes();return[].concat(Object(a["a"])(r),[u.a.note(this.root).interval("P8").interval("P8").interval("P8").interval("P8")])}},watch:{chord:function(){console.log("chord:",this.chord),y("improvNotes:",this.improvNotes),y("droneNotes:",this.droneNotes)},root:function(){console.log("root:",this.root),y("improvNotes:",this.improvNotes),y("droneNotes:",this.droneNotes),this.rootSynth.frequency.value=this.root},pulse:function(){console.log("pulse:",this.pulse),this.loop.interval=this.pulse},volume:function(){console.log("vol:",this.volume),l.a.Master.volume.rampTo(this.volume,.01)}},created:function(){var t=this;document.addEventListener("keypress",(function(e){console.log(e)," "===e.key&&t.toggleDrone()})),this.initSound(),this.initDroneLoop()},mounted:function(){var t=this;this.initKnobs(),this.setRandomConfiguration(),window.addEventListener("resize",(function(){return t.resize()})),this.resize(),Object(f["disableBodyScroll"])(document.querySelectorAll("#canvas"))},methods:{initDroneLoop:function(){var t=this;this.loop=new l.a.Loop((function(){t.chosenNote||(t.chosenNote=u.a.note(t.root));var e=Object(d["sample"])(t.droneNotes.filter((function(e){return e.scientific()!==t.chosenNote.scientific()})));t.chosenNote=e;var n=Object(d["sample"])(["2n","2n","2n","2n","4n","4n","8n"]);console.log({note:e.scientific(),dur:n}),t.droneSynth.triggerAttackRelease(e.scientific(),n,l.a.now(),Object(d["random"])(.6,1)),t.droneSynth2.triggerAttackRelease(e.scientific(),n,l.a.now(),Object(d["random"])(.6,1))}),this.pulse),this.loop.start(0)},initSound:function(){l.a.Transport.bpm.value=60;var t=new l.a.Reverb;t.decay=3.5,t.preDelay=.01,t.generate(),this.rootSynth=new l.a.Synth({oscillator:{type:"sine",frequency:this.root,detune:0,phase:0},envelope:{attack:.25,decay:.5,sustain:.1,release:.05}}),this.droneSynth=new l.a.PolySynth(6,l.a.Synth).chain(l.a.Master),this.droneSynth.set({oscillator:{type:"sine",detune:0,volume:0},envelope:{attack:.25,decay:.5,sustain:.1,release:.05}}),this.droneSynth2=new l.a.PolySynth(6,l.a.Synth).chain(l.a.Master),this.droneSynth2.set({oscillator:{type:"triangle",detune:1200,volume:-3},envelope:{attack:.25,decay:.5,sustain:.1,release:.05}}),this.compressor=new l.a.Compressor,this.improvSynth=new l.a.PolySynth(6,l.a.Synth).chain(t,this.compressor),this.improvSynth.set({oscillator:{type:"sine",detune:0,volume:3},envelope:{attack:.005,decay:.5,sustain:.1,release:.1}}),this.improvSynth2=new l.a.PolySynth(1,l.a.Synth).chain(this.compressor),this.improvSynth2.set({oscillator:{type:"sine",detune:0,volume:3},envelope:{attack:.05,decay:.1,sustain:.1,release:.1}}),this.improvSynth3=new l.a.PolySynth(3,l.a.Synth).chain(this.compressor),this.improvSynth3.set({oscillator:{type:"sine",detune:0,volume:3},envelope:{attack:.005,decay:.05,sustain:.002,release:.001}}),this.improvSynth4=new l.a.PolySynth(1,l.a.Synth).chain(t,this.compressor),this.improvSynth4.set({oscillator:{type:"triangle",detune:0,volume:-3},envelope:{attack:.005,decay:.05,sustain:.05,release:.05}}),window.rootSynth=this.rootSynth,window.droneSynth=this.droneSynth,window.droneSynth2=this.droneSynth2,window.improvSynth=this.improvSynth,window.improvSynth2=this.improvSynth2,window.improvSynth3=this.improvSynth3,window.improvSynth4=this.improvSynth4,this.compressor.connect(l.a.Master)},setRandomConfiguration:function(){var t=this;this.knobs.forEach((function(e){if("volume"!==e.id){var n=Math.floor(Math.random()*e.options.length),o=m(n,0,e.options.length-1,t.minY,t.maxY);t.setKnobPosition(e,e.x,o)}}));var e=this.knobs.find((function(t){return"volume"===t.id}));this.setKnobPosition(e,e.x,this.middleY-this.halfThird/2)},touch:function(t){this.touched=!0;var e=t.touches[t.touches.length-1];this.improv(e.pageX,e.pageY)},click:function(t){this.touched||(console.log(t),this.improv(t.offsetX,t.offsetY))},improv:function(t,e){var n=this,i="improv-circle-".concat(++this.lastImprovCircleId);this.improvCircles.push({x:t,y:e,r:10,id:i});var r=Math.max(0,m(e,this.maxY,0,0,1)),a=Math.floor(m(t,0,this.width+1,0,this.improvNotes.length)),s=this.improvNotes[a];console.log("improv:",s.scientific(),"@",r),this.improvSynth.triggerAttackRelease(s.scientific(),this.improvNoteDuration,l.a.now(),r),this.improvSynth2.triggerAttackRelease(s.scientific(),this.improvNoteDuration,l.a.now(),r),this.improvSynth3.triggerAttackRelease(s.scientific(),this.improvNoteDuration,l.a.now(),r),this.improvSynth4.triggerAttackRelease(s.scientific(),this.improvNoteDuration,l.a.now(),r),o["a"].nextTick((function(){v["b"].to("#".concat(i),n.improvNoteDuration.toSeconds(),{attr:{r:50},opacity:0,ease:v["a"].easeNone,onComplete:function(){n.improvCircles=n.improvCircles.filter((function(t){return t.id!==i}))}})}))},resize:function(){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px")),this.previousWidth=this.width,this.previousHeight=this.height,this.width=this.$el.clientWidth,this.height=this.$el.clientHeight,this.updateKnobsPositions()},initKnobs:function(){var t=this;this.knobs.forEach((function(e){var n="#".concat(e.id),o=t;e.draggable=h["a"].create(n,{type:"y",cursor:"pointer",onDrag:function(){o.setKnobPosition(e,this.x,this.y)}})[0]}))},updateKnobsPositions:function(){var t=this;this.knobs.forEach((function(e,n){var o=t.width/t.knobs.length,i=o/2+o*n,r=m(e.y,0,t.previousHeight,0,t.height);t.setKnobPosition(e,i,r),e.draggable.applyBounds({minY:t.minY,maxY:t.maxY})}))},setKnobPosition:function(t,e,n){if(v["b"].set("#".concat(t.id),{x:e,y:n}),t.x=e,t.y=n,t.draggable.update(),"volume"===t.id){var o=m(n,this.maxY,this.minY,t.minValue,t.maxValue);o=o<=t.minValue+.5?-1/0:o,t.activeValue=o}else{var i=Math.round(m(n,this.maxY,this.minY,0,t.options.length-1));t.activeValue=t.options[i].value,t.activeLabel=t.options[i].label}this.updateCurvePoints()},updateCurvePoints:function(){var t=this.knobs.map((function(t){return{x:t.x,y:t.y}}));t.unshift({x:0,y:this.height/2}),t.push({x:this.width,y:this.height/2}),this.curvePoints=t},toggleDrone:function(){if(this.playing=!this.playing,!this.playing)return l.a.Master.volume.rampTo(-120,.5),l.a.Transport.stop(),void this.loop.stop();l.a.Master.volume.value=-1/0,l.a.Master.volume.rampTo(this.volume,.5),this.rootSynth.triggerAttack(this.root),l.a.Transport.start(),this.loop.start()}}},b=g,w=(n("5c0b"),n("2877")),S=Object(w["a"])(b,i,r,!1,null,null,null),k=S.exports,P=n("9483");Object(P["a"])("".concat("/DigiDrone/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(k)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var o=n("9c0c"),i=n.n(o);i.a},"9c0c":function(t,e,n){}});
//# sourceMappingURL=app.d401fbb3.js.map